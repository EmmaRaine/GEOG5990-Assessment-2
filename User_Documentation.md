# Development Process

The first stage of mdoel creation was reading in the drunk.plan text file to the town list and extracting house and pub points to manually plot in the model. It became clear that houses and the pub were not just one point on the map but rather a series of coordinates. To retrieve these points, a loop was created using the town file, enumerating to obtain the house and pub x/y coordinates and saving these to a corresponding list. To plot these coordinates, another loop was created, stating the length of the environment, before specifying the lists containing the x and y coordinates as the x and y coordinates to be plotted. This produced a plot of the 

I created a House class which took the coordinates of the building and the number as positional arguments (which could be provided from my dictionary). I then calculated the building’s bottom left, width, and height as properties so it would be easy to plot the rectangle. I knew I wanted the drunks to exit the pub and enter the houses at specific points, so I calculated the midway point of the width and added a door. After repeating this process for the pub, I realised the code was almost identical (other than the number argument) so I created a super class called Building, the two further sub classes, House and Pub. I plotted the bottom left and top right points, along with house numbers and labels, to ensure they were calculated correctly and matched the layout of the initial figure.

It was now time to make some drunks! I knew the drunks would need access to the house for the number and door, and the pub for the door, so initialised them with these parameters, alongside x and y values. They would also need access to the drunks list to remove themselves from it when they reached home, and access to the plan to check the points which they weren’t allowed to walk (any value wasn’t equal to 0 on the original plan). I created a drunk per house in the model code and set the x and y values to the pub’s door as this would be their initial starting point. I created a random walk method which moved the drunks at random and animated the drunks’ movement so I could visualise them. This initial animation process was difficult as it required me to look into how to animate using rectangles and text. Initially I couldn’t get the rectangles to plot until I found the plt.gca() method, which effectively plotted the buildings and text.

I noticed that the drunks were walking through the pub so remembered to add boundary checks to prevent this, and to ensure they didn’t try to walk past the perimeters of the plan. I initially copied my boundary check from assignment 1, which allowed the drunks to move to the spot then corrected for that before plotting and added the aspect to check for buildings. This seemed to work, but when I ran the movement for 1000 iterations, I got an error. The drunks would try and move beyond the boundary, then when they were completing the building check, the point they were at was beyond the contents of the plan (which they referred to for the building check). Therefore, both checks needed to be preventative rather than corrective. I ran the code again, this time animating and giving the drunks initial x and y coordinates close to the perimeter. They bounced off appropriately.

I then wanted to add a more direct aspect to their walk, creating a walk directly home method. Visualizing this, I noticed the drunks got stuck on the perimeters of their house if they had to go round the building to access the door. I incorporated some randomness into the walk and the problem continued as every time they moved away, they were pulled back to the blockage due to the direct walk. After trialling several different methods (adding more randomness at points, moving in a certain direction when blocked) I still couldn’t get the drunks at the bottom of the map to reach their doors. I considered moving the doors to the top of the house so they could avoid walking round the house, but this didn’t feel right. I decided to add a ‘retargeting’ stage that would happen if the drunk was unable to move due to blockage. This consisted of the drunk finding another target (initially set as the door) in the radius of the door, moving there, and trying again to access the door. This meant they could come at it from a different angle and potentially not get stuck. Randomness was still kept in at this stage to ensure the walk still appeared to represent that of a drunk person’s, and after animating the movement it looked good, but another issue was discovered. As the drunks were blocked from accessing any point which was marked with a number other than 0 on the plan, they couldn't access their front door to remove themselves from the list. I created an exception to this in the code, ran the animation again, and watched all the drunks successfully move home.

As a final step in developing the movement I wanted to make the walk more interesting, so ensured it was more random the further the drunks were from home. If their distance was 50 or above they walked with 90% chance of randomness and 10% direct, then when it was below 50 they walked with 30% randomness and 70% direct. I kept some directness in their initial walk as even if they were very drunk, they’d still know the general direction. And I maintained randomness in their direct walk as they were still drunk and would stumble or lose their way every once in a while.

Finally, the routes taken by the drunks needed to be presented as a heat map and written out to a file. I created a nested list full of 0’s which matched the perimeters of the plan and added a method to the drunk class which adds 1 the spot it passes. I then plotted this information and noticed the heat map was not initially very visually interesting. The most visited spots completely overwhelmed the individual paths, so I converted the list to a numpy array and applied a logarithm to give the higher values less weight. This scaled the values and resulted in a much nicer and clearer heat map. I then wrote this file out to a csv.
